#include <ap_fixed.h>
#include <hls_math.h>
#include "heading_error_ffnn.h"
// ------------------------
// 타입 정의
// ------------------------
typedef ap_fixed<16,8> fixed16_8;// weight, bias, sum, layer
typedef ap_fixed<16,2> fixed16_2;// input, window_buffer, input_vector

// ------------------------
// FFNN 구조
// ------------------------
#define FEATURE_SIZE 6
#define INPUT_SIZE 6
#define L1 64
#define L2 32
#define L3 16
#define OUTPUT_SIZE 2

// ------------------------
// sigmoid LUT
// Python으로 계산 후 넣은 예시
// ------------------------
#define SIGMOID_LUT_SIZE 512
const fixed16_2 sigmoid_lut[SIGMOID_LUT_SIZE] = {
  0.00033535f,   0.00034601f,   0.00035701f,   0.00036837f,   0.00038008f,   0.00039216f,   0.00040463f,   0.00041749f,
  0.00043077f,   0.00044446f,   0.00045859f,   0.00047317f,   0.00048822f,   0.00050374f,   0.00051975f,   0.00053627f,
  0.00055332f,   0.00057091f,   0.00058906f,   0.00060778f,   0.00062710f,   0.00064703f,   0.00066760f,   0.00068882f,
  0.00071071f,   0.00073330f,   0.00075661f,   0.00078065f,   0.00080546f,   0.00083106f,   0.00085747f,   0.00088472f,
  0.00091283f,   0.00094184f,   0.00097177f,   0.00100265f,   0.00103450f,   0.00106737f,   0.00110128f,   0.00113627f,
  0.00117237f,   0.00120962f,   0.00124804f,   0.00128769f,   0.00132859f,   0.00137079f,   0.00141433f,   0.00145925f,
  0.00150559f,   0.00155340f,   0.00160273f,   0.00165362f,   0.00170613f,   0.00176030f,   0.00181619f,   0.00187385f,
  0.00193333f,   0.00199470f,   0.00205802f,   0.00212333f,   0.00219072f,   0.00226024f,   0.00233197f,   0.00240596f,
  0.00248230f,   0.00256105f,   0.00264229f,   0.00272610f,   0.00281257f,   0.00290176f,   0.00299378f,   0.00308871f,
  0.00318664f,   0.00328766f,   0.00339188f,   0.00349938f,   0.00361028f,   0.00372469f,   0.00384270f,   0.00396444f,
  0.00409002f,   0.00421956f,   0.00435318f,   0.00449102f,   0.00463320f,   0.00477986f,   0.00493115f,   0.00508719f,
  0.00524815f,   0.00541417f,   0.00558541f,   0.00576204f,   0.00594422f,   0.00613213f,   0.00632593f,   0.00652583f,
  0.00673199f,   0.00694463f,   0.00716393f,   0.00739011f,   0.00762337f,   0.00786393f,   0.00811203f,   0.00836788f,
  0.00863174f,   0.00890384f,   0.00918444f,   0.00947380f,   0.00977218f,   0.01007987f,   0.01039714f,   0.01072429f,
  0.01106162f,   0.01140944f,   0.01176806f,   0.01213782f,   0.01251905f,   0.01291209f,   0.01331731f,   0.01373507f,
  0.01416575f,   0.01460973f,   0.01506741f,   0.01553920f,   0.01602553f,   0.01652682f,   0.01704352f,   0.01757609f,
  0.01812499f,   0.01869071f,   0.01927374f,   0.01987459f,   0.02049377f,   0.02113183f,   0.02178932f,   0.02246679f,
  0.02316482f,   0.02388402f,   0.02462498f,   0.02538833f,   0.02617471f,   0.02698477f,   0.02781918f,   0.02867864f,
  0.02956384f,   0.03047550f,   0.03141437f,   0.03238120f,   0.03337675f,   0.03440183f,   0.03545724f,   0.03654379f,
  0.03766235f,   0.03881376f,   0.03999891f,   0.04121870f,   0.04247404f,   0.04376586f,   0.04509513f,   0.04646280f,
  0.04786988f,   0.04931736f,   0.05080628f,   0.05233767f,   0.05391260f,   0.05553215f,   0.05719741f,   0.05890949f,
  0.06066951f,   0.06247864f,   0.06433801f,   0.06624881f,   0.06821222f,   0.07022944f,   0.07230169f,   0.07443019f,
  0.07661617f,   0.07886089f,   0.08116559f,   0.08353154f,   0.08596001f,   0.08845226f,   0.09100957f,   0.09363323f,
  0.09632451f,   0.09908468f,   0.10191503f,   0.10481682f,   0.10779132f,   0.11083977f,   0.11396343f,   0.11716352f,
  0.12044125f,   0.12379781f,   0.12723440f,   0.13075214f,   0.13435217f,   0.13803558f,   0.14180343f,   0.14565675f,
  0.14959652f,   0.15362370f,   0.15773919f,   0.16194383f,   0.16623842f,   0.17062372f,   0.17510040f,   0.17966910f,
  0.18433036f,   0.18908468f,   0.19393247f,   0.19887406f,   0.20390972f,   0.20903962f,   0.21426384f,   0.21958237f,
  0.22499512f,   0.23050189f,   0.23610237f,   0.24179617f,   0.24758278f,   0.25346158f,   0.25943184f,   0.26549271f,
  0.27164325f,   0.27788236f,   0.28420885f,   0.29062142f,   0.29711861f,   0.30369887f,   0.31036051f,   0.31710173f,
  0.32392059f,   0.33081506f,   0.33778295f,   0.34482199f,   0.35192975f,   0.35910372f,   0.36634127f,   0.37363964f,
  0.38099599f,   0.38840736f,   0.39587070f,   0.40338287f,   0.41094062f,   0.41854063f,   0.42617951f,   0.43385378f,
  0.44155990f,   0.44929428f,   0.45705325f,   0.46483311f,   0.47263013f,   0.48044051f,   0.48826047f,   0.49608619f,
  0.50391381f,   0.51173953f,   0.51955949f,   0.52736987f,   0.53516689f,   0.54294675f,   0.55070572f,   0.55844010f,
  0.56614622f,   0.57382049f,   0.58145937f,   0.58905938f,   0.59661713f,   0.60412930f,   0.61159264f,   0.61900401f,
  0.62636036f,   0.63365873f,   0.64089628f,   0.64807025f,   0.65517801f,   0.66221705f,   0.66918494f,   0.67607941f,
  0.68289827f,   0.68963949f,   0.69630113f,   0.70288139f,   0.70937858f,   0.71579115f,   0.72211764f,   0.72835675f,
  0.73450729f,   0.74056816f,   0.74653842f,   0.75241722f,   0.75820383f,   0.76389763f,   0.76949811f,   0.77500488f,
  0.78041763f,   0.78573616f,   0.79096038f,   0.79609028f,   0.80112594f,   0.80606753f,   0.81091532f,   0.81566964f,
  0.82033090f,   0.82489960f,   0.82937628f,   0.83376158f,   0.83805617f,   0.84226081f,   0.84637630f,   0.85040348f,
  0.85434325f,   0.85819657f,   0.86196442f,   0.86564783f,   0.86924786f,   0.87276560f,   0.87620219f,   0.87955875f,
  0.88283648f,   0.88603657f,   0.88916023f,   0.89220868f,   0.89518318f,   0.89808497f,   0.90091532f,   0.90367549f,
  0.90636677f,   0.90899043f,   0.91154774f,   0.91403999f,   0.91646846f,   0.91883441f,   0.92113911f,   0.92338383f,
  0.92556981f,   0.92769831f,   0.92977056f,   0.93178778f,   0.93375119f,   0.93566199f,   0.93752136f,   0.93933049f,
  0.94109051f,   0.94280259f,   0.94446785f,   0.94608740f,   0.94766233f,   0.94919372f,   0.95068264f,   0.95213012f,
  0.95353720f,   0.95490487f,   0.95623414f,   0.95752596f,   0.95878130f,   0.96000109f,   0.96118624f,   0.96233765f,
  0.96345621f,   0.96454276f,   0.96559817f,   0.96662325f,   0.96761880f,   0.96858563f,   0.96952450f,   0.97043616f,
  0.97132136f,   0.97218082f,   0.97301523f,   0.97382529f,   0.97461167f,   0.97537502f,   0.97611598f,   0.97683518f,
  0.97753321f,   0.97821068f,   0.97886817f,   0.97950623f,   0.98012541f,   0.98072626f,   0.98130929f,   0.98187501f,
  0.98242391f,   0.98295648f,   0.98347318f,   0.98397447f,   0.98446080f,   0.98493259f,   0.98539027f,   0.98583425f,
  0.98626493f,   0.98668269f,   0.98708791f,   0.98748095f,   0.98786218f,   0.98823194f,   0.98859056f,   0.98893838f,
  0.98927571f,   0.98960286f,   0.98992013f,   0.99022782f,   0.99052620f,   0.99081556f,   0.99109616f,   0.99136826f,
  0.99163212f,   0.99188797f,   0.99213607f,   0.99237663f,   0.99260989f,   0.99283607f,   0.99305537f,   0.99326801f,
  0.99347417f,   0.99367407f,   0.99386787f,   0.99405578f,   0.99423796f,   0.99441459f,   0.99458583f,   0.99475185f,
  0.99491281f,   0.99506885f,   0.99522014f,   0.99536680f,   0.99550898f,   0.99564682f,   0.99578044f,   0.99590998f,
  0.99603556f,   0.99615730f,   0.99627531f,   0.99638972f,   0.99650062f,   0.99660812f,   0.99671234f,   0.99681336f,
  0.99691129f,   0.99700622f,   0.99709824f,   0.99718743f,   0.99727390f,   0.99735771f,   0.99743895f,   0.99751770f,
  0.99759404f,   0.99766803f,   0.99773976f,   0.99780928f,   0.99787667f,   0.99794198f,   0.99800530f,   0.99806667f,
  0.99812615f,   0.99818381f,   0.99823970f,   0.99829387f,   0.99834638f,   0.99839727f,   0.99844660f,   0.99849441f,
  0.99854075f,   0.99858567f,   0.99862921f,   0.99867141f,   0.99871231f,   0.99875196f,   0.99879038f,   0.99882763f,
  0.99886373f,   0.99889872f,   0.99893263f,   0.99896550f,   0.99899735f,   0.99902823f,   0.99905816f,   0.99908717f,
  0.99911528f,   0.99914253f,   0.99916894f,   0.99919454f,   0.99921935f,   0.99924339f,   0.99926670f,   0.99928929f,
  0.99931118f,   0.99933240f,   0.99935297f,   0.99937290f,   0.99939222f,   0.99941094f,   0.99942909f,   0.99944668f,
  0.99946373f,   0.99948025f,   0.99949626f,   0.99951178f,   0.99952683f,   0.99954141f,   0.99955554f,   0.99956923f,
  0.99958251f,   0.99959537f,   0.99960784f,   0.99961992f,   0.99963163f,   0.99964299f,   0.99965399f,   0.99966465f,
};

// Layer 1 Weights (6 x 64)
const fixed16_2 W1[6][64] = {
    { 0.11497423, 0.11754043, 0.06835594, 0.11328005, 0.27963808, 0.34645194, -0.09157048, 0.19428304, -0.28300098, -0.04336743, 0.03703798, 0.33018091, 0.31992236, 0.30997261, 0.09864232, -0.06488749, 0.25358418, 0.25909302, -0.00398723, -0.04600428, -0.23126829, 0.28832415, 0.15350153, -0.25919905, -0.12756321, -0.00241543, 0.27498454, -0.21690167, -0.07815343, -0.19858126, -0.09547457, -0.13761993, 0.21679068, -0.20448637, -0.00814326, 0.18855587, 0.20304351, 0.08635984, -0.25545159, 0.24307317, 0.12395083, -0.18306904, 0.11272299, -0.04620130, 0.22830352, 0.00417080, 0.04698151, 0.15296844, 0.18720761, 0.09538049, -0.19414596, 0.16959068, -0.06796439, -0.06168400, -0.07176562, -0.08882666, -0.15981583, -0.23359722, 0.33372691, -0.03795514, -0.27117068, -0.29080462, -0.12681665, -0.04469143 },
    { 0.18923166, 0.13286728, 0.18247744, 0.13108489, -0.03152528, 0.04259977, -0.07340693, -0.15815283, -0.25028634, 0.27148306, 0.21588284, 0.06401581, -0.20559999, 0.02747902, -0.05798905, -0.10782342, -0.24061906, 0.10983512, 0.16011518, 0.01079297, -0.12690257, 0.11910912, 0.05284214, 0.01464394, -0.27019605, -0.00681335, 0.08505204, 0.17759228, -0.22751112, 0.07081807, 0.04819766, -0.28305271, -0.06596544, 0.18321705, 0.04623517, -0.16291247, -0.13555449, -0.07422215, -0.22107819, 0.02677771, 0.19696125, -0.17104830, -0.18041933, -0.26644406, 0.04473642, -0.09362692, -0.27850017, -0.06327954, 0.12375772, 0.05079415, 0.09210753, 0.05693176, -0.24775022, -0.00394988, -0.15157436, 0.01871744, 0.25360727, 0.09210879, 0.05079696, 0.23212230, -0.23644289, -0.06839307, 0.13214949, 0.18830192 },
    { 0.05592814, 0.28379011, 0.06982541, -0.13044082, 0.20615637, 0.26524460, 0.17366385, -0.17259280, -0.14948206, -0.14149141, 0.28635037, 0.01099545, -0.01326492, 0.04442537, 0.24524587, -0.23612083, 0.24924171, -0.28526402, 0.15609083, 0.05453175, 0.19182712, 0.22768587, 0.00354412, -0.23879515, -0.23247480, -0.22818059, -0.06447963, 0.25011659, 0.17447600, 0.20499879, 0.00613189, 0.24790424, 0.25906956, -0.26861519, 0.02649787, 0.07435346, -0.13778055, 0.09397948, -0.06911692, -0.20735243, 0.13277534, -0.28426811, -0.20194286, 0.10883072, -0.16527171, 0.23181945, -0.22728804, -0.10207622, 0.26031530, -0.15834974, -0.18279573, 0.21560824, 0.15862650, 0.28890747, 0.14189723, -0.00546554, 0.11036617, 0.02898270, 0.02633056, -0.16932601, -0.21413192, 0.06635702, -0.26373735, 0.07156047 },
    { -0.10701822, 0.08533827, -0.30779248, -0.16499902, -0.00578484, 0.00763955, -0.25290784, 0.09403019, 0.01009139, -0.21146677, -0.30060533, 0.04851634, 0.07821073, 0.12364008, -0.04034097, 0.06045243, -0.21701302, -0.08092251, -0.13162720, -0.24721248, -0.01562917, -0.20396362, -0.23724532, 0.29098308, -0.45681164, 0.05129679, 0.07185984, 0.21034011, -0.09738727, 0.04209744, 0.03660710, 0.34517583, 0.20646909, 0.03681424, -0.06327157, -0.22948755, 0.29986450, 0.18060714, -0.29694313, 0.07740744, -0.04458001, -0.49465230, -0.26841706, -0.16635120, 0.27060878, -0.11817603, 0.04568117, -0.10162755, 0.07539248, -0.16479747, 0.18142830, 0.23577592, -0.25298551, 0.35381937, 0.27851337, -0.29150623, 0.02789310, 0.12184724, 0.16286387, 0.54253995, -0.22673495, 0.17899370, -0.39736941, -0.40994290 },
    { -0.03118929, -0.09644906, 0.19491306, 0.20019001, -0.21033400, 0.35450435, -0.31116375, -0.26457062, 0.21742713, -0.22703509, 0.48262134, 0.14237747, -0.07424861, 0.00407583, 0.02292683, 0.02238071, 0.02497227, -0.23509867, 0.18514194, 0.25886858, 0.19194627, 0.27425566, -0.24465013, 0.19079238, -0.15263435, -0.29851121, -0.00193339, -0.14309695, -0.32585868, -0.10795694, -0.06468291, -0.09467353, 0.08350109, 0.07956815, 0.30630881, 0.22087014, 0.06641561, 0.15162508, -0.00318736, -0.16179273, -0.17417033, -0.22036135, -0.20557153, 0.04861456, 0.09178822, -0.04187640, 0.15067200, 0.39637169, -0.20117095, 0.27125660, -0.00225128, 0.13455825, -0.32074824, -0.08038592, 0.09676877, -0.25894034, -0.06568594, 0.28740889, 0.35998505, -0.54177231, -0.24773905, 0.26740754, -0.21646781, 0.20562735 },
    { -0.19505830, 0.11944921, 0.19199276, -0.13913874, -0.12009542, 0.08393633, -0.11908962, 0.20780858, 0.20443285, -0.05238282, 0.10595818, 0.14327991, -0.22819294, -0.04137586, 0.00656923, -0.01621976, 0.20505887, -0.17610100, -0.00294786, 0.25134525, 0.06613889, 0.08640971, -0.16711174, 0.03337210, 0.12397891, 0.31939235, -0.10089091, -0.09948975, -0.09581444, 0.03316510, 0.16025935, 0.34482771, -0.01503269, 0.13165292, -0.19274113, 0.01613353, 0.02285530, -0.23134512, -0.20193630, 0.20385982, -0.19449128, 0.03943536, 0.24718751, 0.21494725, 0.02770551, 0.05208191, -0.07995002, -0.18557911, -0.22312234, -0.08406683, 0.31193537, 0.18553899, 0.01120226, 0.22410342, 0.13410246, -0.18068814, 0.23282884, -0.16240852, 0.05995049, 0.02423344, 0.11679612, 0.22242188, -0.01925384, 0.07322741 },
};

// Layer 1 Bias (64)
const fixed16_2 b1[64] = { 0.04376710, 0.07176667, 0.05391653, -0.03848086, 0.05804590, 0.05402951, 0.05916074, 0.05176869, 0.00000000, -0.02287880, 0.11185974, 0.06639665, 0.06165929, 0.05417135, 0.02526175, 0.00000000, -0.01479203, 0.06163602, -0.01788398, -0.01508922, 0.00000000, 0.04517283, 0.04968803, 0.00000000, 0.13063550, 0.06615270, 0.04928283, 0.03262442, 0.08334504, 0.00607905, 0.05505910, 0.12970330, -0.00803683, 0.00000000, 0.08573958, 0.01233733, 0.06097988, 0.01597739, -0.03773902, 0.06054761, 0.02083791, 0.08183633, 0.05897802, -0.02307986, 0.02610848, -0.03112845, -0.00779747, 0.04212557, 0.05331120, 0.07094683, -0.01939878, 0.07719231, -0.01243729, 0.03249104, 0.00000000, 0.01824760, -0.04563975, 0.00000000, 0.06914853, 0.09532454, -0.01101089, 0.00000000, 0.04271059, 0.04681019 };

// Layer 2 Weights (64 x 32)
const fixed16_2 W2[64][32] = {
    { 0.23759653, 0.02971165, -0.20096427, 0.15044567, 0.00562752, -0.20647343, 0.03926386, 0.17349653, -0.04318793, 0.11077531, -0.12207704, 0.17792162, 0.14153011, -0.01261638, 0.24048023, -0.16731456, 0.02562124, 0.24096973, 0.07813399, 0.13919711, -0.00825489, 0.04046898, -0.07185548, -0.17938481, 0.25289229, 0.06372295, -0.19670160, 0.05703286, 0.21149750, -0.21002193, -0.01595790, 0.15842156 },
    { 0.28215942, -0.20014544, -0.15606046, 0.12227222, 0.08477011, -0.11349269, -0.04884822, -0.04966915, -0.09430498, 0.23991418, -0.08867657, 0.21041617, 0.13950811, -0.14457566, -0.19349910, 0.24147630, 0.14727098, 0.11246680, 0.23834620, 0.26834002, 0.17769051, 0.00900192, 0.06193396, 0.23274894, 0.14510240, 0.03278121, -0.21718688, 0.12217545, 0.08163973, -0.11052153, -0.18240325, 0.35296792 },
    { 0.12451645, 0.14405946, 0.08377610, -0.14587469, 0.21396795, -0.22551467, -0.08888627, -0.02967960, 0.15489592, 0.09686138, -0.05136112, 0.05076155, 0.03371146, -0.07518032, 0.22866108, 0.17182665, 0.22804339, 0.25649828, -0.04927040, -0.08433945, 0.15444642, 0.12743001, 0.15468609, -0.05238119, -0.21779251, 0.32774076, 0.08258515, 0.20643902, 0.00921386, -0.01234937, 0.30593398, -0.04419104 },
    { -0.03879307, 0.31022793, -0.02249740, 0.11123481, 0.08634580, 0.09607770, -0.03457513, -0.27915305, -0.24272445, -0.21467876, -0.12183284, 0.27678880, 0.15824498, 0.07172377, 0.12445160, 0.11980244, 0.02208112, -0.16567980, -0.16851626, 0.14228569, -0.03032351, 0.06953144, -0.08215051, -0.15853830, 0.13446106, -0.10848551, 0.08157144, -0.20734918, 0.03211614, -0.07517426, -0.19230489, 0.11248053 },
    { 0.02050559, -0.08645055, 0.11348022, -0.21266687, 0.13610767, 0.13829565, 0.25891003, 0.04440591, 0.07935658, -0.18835786, -0.19510280, 0.06527559, 0.04400028, -0.04409564, -0.09693246, 0.29265469, 0.08637269, 0.25049704, -0.20749995, 0.21868989, 0.06849265, 0.12955493, 0.14107698, -0.08526778, 0.03617746, 0.00679944, -0.20376419, 0.03610925, 0.09653527, -0.06370175, 0.24810009, 0.13840222 },
    { -0.01156933, -0.12836647, 0.17913558, 0.15579109, 0.15187338, -0.19064932, -0.18693377, -0.26116496, -0.19305058, 0.20042020, 0.05474328, -0.11011843, -0.01245363, 0.16994098, 0.18992887, 0.20871624, -0.11989155, 0.28352183, -0.02538351, 0.22991498, -0.11419076, 0.13352926, 0.08250742, 0.26390174, -0.00183266, -0.11485227, -0.03973658, 0.18468288, 0.29988685, 0.07824098, -0.00938852, 0.02259656 },
    { -0.07513182, 0.32686859, 0.32462779, -0.02879064, 0.10344334, -0.08880061, 0.04523687, 0.25058123, -0.03206772, 0.24907805, -0.05468073, -0.13221647, -0.27287328, -0.50238669, -0.12649904, -0.05076195, -0.03542383, 0.06668042, -0.21152134, 0.00514789, -0.07887155, 0.00680435, -0.08436266, 0.22914706, 0.04776948, 0.37669912, 0.02201878, 0.00811896, 0.01071650, -0.16760027, 0.15623249, -0.01795519 },
    { -0.00308234, 0.22873399, -0.28365552, 0.15941902, -0.10202994, -0.15097301, 0.23550585, 0.09644938, 0.12996897, 0.12361550, 0.15736842, 0.20525059, 0.06626230, -0.15208960, 0.20871870, 0.13645364, 0.23292874, 0.29847234, -0.09686095, -0.10735637, -0.12310916, -0.09928083, -0.09389491, 0.06936353, 0.29308543, -0.03089917, 0.17236958, 0.14073493, -0.11605997, -0.17580621, 0.00181811, 0.22625796 },
    { -0.18933672, -0.00324768, -0.18016601, 0.22618061, 0.18666917, 0.22627312, -0.07882220, -0.17511070, -0.22925615, -0.19933617, 0.04408765, 0.16439533, 0.18643707, 0.07017165, -0.04425895, -0.15227383, -0.05324376, 0.16061240, -0.17966861, -0.19951075, 0.01983142, 0.19343990, 0.18183011, 0.02887374, 0.16133910, 0.13836741, 0.00767750, -0.05862772, -0.17380697, -0.17685467, 0.12167895, 0.02617610 },
    { 0.19896728, 0.23929408, 0.04523049, 0.11909228, -0.09488081, 0.01777800, -0.14614384, 0.11637865, 0.15624888, -0.25355437, 0.10223504, -0.18858942, -0.21292454, -0.29354781, -0.20086893, 0.13879219, 0.12072974, -0.04519607, 0.11366514, -0.19084275, -0.09074759, -0.09901503, 0.25749555, -0.21556038, -0.02345645, -0.10779509, -0.16928987, -0.10796674, 0.12211975, -0.10617410, -0.10383477, -0.23291910 },
    { 0.24696596, 0.30901206, -0.12136625, -0.18220541, -0.04870854, -0.24586147, -0.30545628, 0.12112535, -0.14880866, 0.06989236, 0.06507706, -0.02112442, 0.13818286, 0.54982221, 0.35409805, 0.26171228, -0.20195925, 0.04004733, 0.27619284, -0.23329051, -0.20474499, -0.15104736, -0.35725421, -0.36013681, -0.37154883, -0.08965335, 0.46272495, -0.19585885, 0.26307955, 0.10111912, 0.27038422, -0.20949541 },
    { 0.29100397, 0.11829866, -0.25613290, -0.15762863, 0.04082516, -0.23972319, 0.08745950, 0.14798447, -0.08368579, 0.07592143, -0.03416163, 0.23789306, -0.09181373, 0.23057516, -0.02919060, 0.00809496, 0.18338145, 0.03978297, 0.03868735, 0.07936794, -0.15326256, -0.07303847, -0.12187134, 0.08014728, -0.07797804, 0.20950353, 0.22296850, -0.06685556, 0.25102311, 0.08063719, 0.24452962, 0.11623502 },
    { -0.10472833, 0.09444225, -0.20866106, -0.08186717, 0.22856769, 0.00504077, 0.05404402, 0.11168247, -0.01521093, 0.08129313, -0.09480288, -0.05779143, 0.21472470, -0.11504254, 0.02424402, 0.04494321, 0.02596958, 0.12002811, -0.00720960, 0.05596710, 0.05451614, 0.08806649, 0.16449000, 0.08560241, 0.07225765, 0.19792195, 0.22160013, -0.03494552, 0.18183488, 0.11841030, 0.20259456, 0.31462920 },
    { -0.05002697, -0.21213210, -0.23821416, 0.12410694, 0.16152363, -0.00771639, -0.12004226, -0.25712386, -0.03128621, 0.06294566, -0.01652884, 0.11685266, -0.13672079, 0.19459461, 0.16351965, 0.26355481, 0.24045180, -0.18280013, -0.02109956, 0.06999369, 0.15539467, -0.07681043, 0.20204839, -0.06906844, -0.04039056, -0.07420664, 0.18896544, 0.20986012, 0.10039865, -0.12459467, 0.28034702, 0.11783344 },
    { -0.02079372, 0.00170579, 0.23101895, -0.23734957, 0.11524567, -0.22460951, -0.17966804, -0.19826068, 0.01035624, -0.23818907, 0.15875395, -0.20449859, 0.08969851, -0.16313979, 0.23988664, -0.02831083, -0.03821689, 0.02172782, 0.19411536, 0.29699394, 0.13538450, -0.11913021, 0.24044320, 0.03378228, 0.10192050, -0.09696282, 0.24635978, 0.04973041, 0.23166779, -0.09077443, -0.00754480, 0.00416709 },
    { 0.04868519, 0.21010584, -0.18197471, -0.13181657, -0.20342523, 0.12600899, 0.05414587, 0.04740930, 0.01646662, 0.07074153, 0.06866550, 0.06319886, -0.03293937, 0.06877553, 0.14024407, 0.17403364, 0.04312134, -0.16173685, 0.08518350, -0.21410823, -0.19605160, -0.11485952, -0.15684491, -0.18936199, -0.20043415, -0.14953446, -0.08890158, 0.11161268, -0.19458312, -0.10358691, -0.22730511, -0.08514977 },
    { 0.13863927, 0.11217052, 0.08889871, -0.23006345, -0.00166388, 0.21640880, -0.13411494, 0.19616321, 0.09188405, 0.07500208, -0.06846663, -0.10769369, 0.08577421, -0.15796056, 0.25249380, 0.17401253, -0.08266992, 0.01131803, 0.22562943, 0.03102957, 0.05327708, -0.09439602, -0.07676762, 0.07827685, -0.13436659, 0.32896683, 0.20963584, 0.20063090, 0.13863093, 0.15731809, 0.19145238, -0.15965194 },
    { 0.01618896, -0.00836147, 0.10182448, 0.12003285, 0.19786307, -0.21416391, 0.06080040, 0.17533514, -0.09002865, -0.12463655, -0.16699751, 0.25699788, 0.03238655, -0.11080388, -0.17471583, 0.02760870, 0.11063740, 0.28958100, -0.20032649, 0.15983805, -0.19543040, 0.17011052, 0.14690226, 0.06206245, 0.00267174, 0.15692851, 0.12739503, -0.05841211, -0.03133792, 0.22114062, 0.12573226, 0.09122810 },
    { -0.09194835, 0.24369696, -0.11253905, 0.06571086, -0.27541891, -0.07380686, 0.01171119, 0.16910632, -0.18080804, 0.36428493, -0.01172035, 0.05153353, -0.04952624, 0.09379454, -0.18733528, -0.04447553, -0.07588789, -0.05916613, 0.14754997, 0.12296166, 0.01395124, 0.16006523, -0.23574595, -0.31132969, 0.15783903, -0.02244990, -0.13500102, -0.00245857, -0.11769463, 0.14332308, -0.24408565, 0.18677413 },
    { 0.24479559, 0.10042638, -0.05697950, -0.10010874, 0.05878083, -0.03746982, 0.15421943, 0.18471929, 0.17379352, 0.07955556, -0.04304685, 0.22389901, -0.05147883, -0.26679757, -0.23134854, -0.20218109, -0.17883179, -0.09135312, 0.04140266, -0.09441288, 0.00288427, 0.15641451, -0.17268118, -0.05194944, -0.03430554, -0.13398954, -0.01217559, -0.16259663, -0.11997414, -0.07784697, 0.01161984, -0.15339321 },
    { 0.19376439, -0.22332126, -0.02382928, -0.24646187, -0.23196012, 0.04286045, 0.05365002, 0.17413861, -0.19201422, -0.19301224, 0.06659967, 0.21871006, 0.22643793, 0.05870104, -0.03070956, 0.09466696, -0.14806145, 0.13890254, -0.09443170, -0.01039934, -0.03828734, -0.06384796, 0.21413493, -0.11239618, -0.05280799, -0.06291342, 0.07615066, 0.22092211, 0.00001377, 0.15371573, 0.21634686, -0.15183932 },
    { 0.15573438, -0.04339548, 0.13422494, 0.09044126, 0.26547283, -0.05432938, 0.23334920, -0.05393749, 0.14047185, 0.18566659, 0.07962128, 0.16382222, 0.08027286, 0.19359007, 0.14425620, -0.04630993, -0.05761113, 0.26416627, 0.16569521, 0.15574092, 0.24771786, -0.03364576, 0.05254872, -0.11613658, -0.14983155, -0.14050353, 0.17979942, 0.18160743, -0.05864760, 0.15945768, 0.09443618, -0.00732138 },
    { -0.07961627, 0.04302098, 0.22385180, -0.08909684, 0.26016417, 0.11070307, -0.01570940, 0.04249331, -0.02804358, 0.17463331, 0.13959429, 0.20260751, 0.03880794, 0.03784265, 0.14132014, 0.18386768, 0.07449256, 0.03179066, -0.02392193, -0.08847139, -0.03613865, -0.16863811, -0.15557276, 0.26984394, 0.11035449, 0.16545887, -0.08344573, 0.11316835, 0.12195090, -0.20887929, 0.27067727, -0.01731435 },
    { -0.23605901, -0.20244503, 0.19460195, -0.00271451, -0.17747784, 0.20990294, -0.05899900, -0.12330955, -0.08269274, -0.11843687, 0.24935770, 0.07635307, -0.19263661, -0.24353051, -0.03384632, -0.01855195, -0.22325349, -0.11915737, 0.18833488, -0.04341853, -0.17826760, -0.09324974, -0.01619571, 0.12277347, -0.20491016, -0.23909986, -0.19519842, 0.10182595, 0.19314891, 0.21563131, 0.21993977, 0.24445182 },
    { -0.00646880, 0.36543298, 0.11058335, 0.20497161, -0.06861642, -0.15251744, -0.02488717, 0.02067589, -0.21229185, 0.03705706, -0.11187305, -0.03295168, -0.34678289, -0.47181818, -0.23493245, -0.15622382, 0.01810746, 0.11209807, -0.78300530, -0.16568434, 0.17393267, 0.17749155, 0.03775472, 0.15282738, -0.20944744, 0.28839484, 0.16272038, 0.04972212, -0.17387740, -0.18500781, 0.04124767, -0.18896244 },
    { 0.06821023, 0.28474241, 0.05100131, -0.20246157, -0.09564679, -0.11982767, 0.15990183, 0.04515606, 0.12297724, -0.08557080, 0.02698670, 0.01655024, -0.16152707, -0.21708019, -0.28107750, -0.07042904, -0.07016539, -0.08868480, -0.02154228, -0.14122653, -0.05376059, -0.14622712, -0.11261078, -0.16470434, 0.11185668, 0.00151551, -0.01251855, 0.04258821, -0.11240094, -0.06247295, -0.18050459, -0.17644873 },
    { 0.06655935, 0.15906678, 0.15576668, -0.05381768, 0.20547417, 0.18876706, 0.17838228, -0.11615177, -0.25149685, -0.16319546, -0.14170210, 0.06918488, -0.24531612, -0.17562060, -0.01512907, 0.19867353, 0.11098994, 0.16185822, 0.02329947, 0.21466692, -0.17014647, -0.16425620, -0.10557015, -0.10143216, 0.22273050, 0.12195175, 0.12384997, 0.03381196, -0.09091590, -0.04217246, -0.01260526, 0.00761088 },
    { 0.09235837, -0.07581265, 0.02351500, -0.01956713, 0.07978991, 0.23732412, -0.07185336, 0.14801496, -0.13653588, 0.25705469, -0.12515558, -0.15406533, -0.22044647, 0.22602171, 0.24322011, 0.21108916, -0.14597175, -0.16665450, -0.22250164, -0.12564163, 0.24884301, 0.24385779, -0.29656672, -0.21627674, 0.22987619, 0.05703999, 0.10535812, -0.30667150, 0.02099647, -0.09205967, -0.25311711, 0.21939482 },
    { 0.14355297, 0.32068300, 0.06998841, -0.23380296, -0.23969343, 0.19905977, -0.07187441, 0.04672237, -0.19267325, 0.09810498, -0.15391743, 0.04496874, -0.30553871, -0.76116717, -0.11132303, 0.05724007, 0.00120349, 0.02405296, -0.95118219, -0.16333149, -0.00352943, 0.08667373, 0.23647536, 0.06731073, 0.26252747, 0.29023996, -0.25844198, -0.08941998, -0.00495338, 0.02155997, -0.11781133, -0.01121360 },
    { -0.09917611, 0.02922716, 0.10611352, 0.11330312, -0.26752725, 0.02092729, -0.13316651, 0.20230135, 0.00375682, -0.11083729, 0.11603162, -0.22231381, -0.02741528, -0.17973410, -0.11673807, 0.04899497, -0.10822061, -0.27789158, -0.22054201, -0.28757298, 0.14750367, -0.11357807, 0.08783437, 0.02779116, 0.06383383, -0.22022778, -0.09012786, -0.03000928, 0.23371130, -0.01394355, -0.27529898, -0.07742798 },
    { 0.13551180, 0.29044384, 0.08028960, 0.01589658, -0.19167310, 0.07490684, 0.13825625, -0.09816852, -0.19448660, 0.06687101, 0.03536256, 0.06741022, -0.21033563, -0.24124011, -0.00671448, 0.06705411, 0.19026755, -0.02163045, 0.17863154, -0.24623157, -0.18856376, -0.14155746, 0.00537690, -0.22700174, 0.08906583, 0.13143872, 0.00022082, 0.05817050, -0.36147410, 0.13430446, 0.04457262, -0.04352034 },
    { 0.03527596, -0.26390472, -0.01109953, 0.17274667, -0.12137678, -0.01779334, 0.03225807, 0.09746478, -0.10432742, 0.18611440, 0.21458775, -0.05934843, 0.59882522, 0.17985673, 0.17706509, 0.31604761, -0.23226492, -0.12306704, -1.05417180, 0.34893519, -0.03315735, -0.19086950, -0.10622635, 0.04951429, 0.20079130, -0.22262448, -0.00192152, 0.21330714, 0.06226926, 0.20298547, 0.11449246, 0.45301828 },
    { -0.10977855, -0.22157180, 0.18248636, 0.18046622, -0.13070478, 0.02567328, -0.00853624, -0.26477653, 0.11064810, -0.24690594, 0.08090357, 0.19641350, -0.06982277, 0.26071882, 0.07052837, 0.00716014, -0.17854273, 0.05202912, -0.21262184, 0.26173511, 0.00571281, 0.09000435, 0.30201161, 0.17369199, 0.21181914, -0.39266446, 0.07125270, -0.17228642, 0.01775828, -0.07968724, 0.12381915, -0.03086854 },
    { -0.18757540, -0.16159415, 0.10026890, 0.07746685, 0.15154117, -0.13551390, 0.01635307, 0.02473599, -0.23897082, -0.20323074, -0.24283606, 0.07943654, -0.18292665, 0.19352049, -0.15078443, -0.01432848, 0.05063128, -0.19430184, 0.21606219, -0.21139371, 0.21823752, -0.15711570, -0.05666882, -0.00714409, 0.21568435, 0.14761555, -0.10970658, -0.06435150, 0.20347041, -0.08449900, -0.11286581, 0.19960344 },
    { 0.25945234, 0.11181085, -0.03317247, -0.22100119, 0.09255947, -0.19791923, -0.09164392, -0.21108302, -0.00176030, 0.15693808, 0.03853351, 0.08434296, 0.03412184, 0.53796691, 0.39643985, -0.06734585, 0.13349243, 0.14743407, 0.29350728, -0.08509168, 0.16049045, -0.08502577, -0.07837835, -0.22696039, -0.08357148, -0.31068909, 0.09991951, -0.26242235, 0.15962163, 0.08101131, -0.16576554, -0.00501715 },
    { 0.23476544, -0.02285904, 0.03541722, 0.17074201, -0.07882565, 0.09197655, -0.03901294, 0.01470617, -0.21148409, 0.16825044, 0.13936688, 0.20153543, 0.04916303, 0.05343179, 0.16031089, 0.28267545, -0.00498801, 0.18713440, 0.22698268, 0.00086556, 0.03056842, 0.02597269, -0.15023191, 0.14475170, -0.10519085, 0.04344631, -0.09198421, -0.14661241, 0.05740446, 0.10459055, 0.14095843, 0.23370568 },
    { 0.19565709, -0.15538046, -0.10800595, -0.18674357, -0.15866511, -0.12193510, 0.19625066, -0.14842127, -0.15268359, -0.08635230, -0.17675550, 0.16807599, 0.10867608, 0.23296829, -0.21369566, -0.09415291, -0.10098851, 0.20752828, 0.08408721, -0.13375196, 0.17555690, -0.12119587, 0.20847949, -0.15257561, 0.04409341, -0.33637989, 0.05856790, 0.29614702, -0.02358954, -0.03739744, 0.22580063, -0.05232233 },
    { 0.19906764, 0.04414170, 0.13809657, 0.17226419, -0.21597826, -0.22555092, -0.16849205, 0.13681635, -0.01798916, 0.06055353, 0.08087350, 0.22723247, -0.18780385, 0.24186535, -0.00587247, -0.03327008, 0.03769586, -0.07414277, 0.24173774, 0.01280041, 0.23237187, 0.00448764, 0.20431674, -0.15644905, -0.08483525, -0.35495940, 0.07980707, 0.20567358, 0.15225670, -0.05632351, -0.11427425, -0.07423874 },
    { -0.30734235, 0.32797450, -0.02278558, 0.16313945, -0.02121218, 0.20346412, 0.06154076, -0.15966882, -0.16172075, -0.06595962, 0.15927660, -0.04587917, -0.10170779, 0.10558684, -0.20778821, -0.13694422, -0.20217723, 0.05349378, -0.16096656, 0.15958302, -0.22064018, -0.07869484, 0.19053373, 0.05496291, -0.04946436, 0.16412845, -0.25407779, 0.03109464, -0.13386734, -0.02219309, -0.15600865, 0.13532478 },
    { -0.06717823, 0.11307147, -0.09276392, 0.13453037, -0.02739252, 0.07964346, 0.26327193, 0.02769312, -0.26005393, -0.08971029, -0.16536915, 0.11304693, 0.19913529, -0.08976245, -0.03010263, 0.14317706, 0.10270926, 0.07767259, -0.06498269, 0.28174025, 0.10138893, 0.06413690, 0.05715833, 0.28733113, 0.23079900, -0.09152198, 0.03772355, 0.19526672, 0.03955777, -0.14767542, 0.22578381, -0.12159237 },
    { 0.17221245, 0.37012708, -0.05535303, 0.03302773, 0.09079374, 0.05138905, 0.24853981, 0.19682072, -0.16417834, 0.18521243, 0.17518158, -0.14158556, -0.14936979, -0.12139571, 0.04085955, 0.04237220, -0.12351274, 0.15567766, 0.17187698, 0.10858640, -0.24577063, -0.08336399, 0.05051419, 0.27915928, 0.18592490, 0.02533909, -0.00792301, -0.04960423, 0.14831093, -0.18719964, 0.02085960, 0.09117205 },
    { 0.00101777, 0.43949148, 0.21788260, -0.03184341, 0.01043390, -0.17407882, -0.15625128, 0.51426876, -0.07544921, 0.00385522, -0.04533809, -0.44006583, -0.95182037, -0.81939375, -0.18834324, -0.05160176, 0.03874789, -0.28781238, -0.48808452, -0.40696713, -0.20257789, -0.22519122, 0.01923497, 0.05030170, -0.21839419, 0.41388887, -0.30713332, 0.02873765, -0.06298923, -0.18931001, -0.26536822, -0.52555251 },
    { 0.22058325, 0.09254646, -0.05614387, 0.13786493, 0.00850363, 0.04162840, 0.16330887, -0.05050648, 0.00229272, -0.13487922, 0.04712723, -0.06838971, -0.26496983, 0.03442881, 0.12222254, 0.02593189, 0.00857403, 0.21748795, -0.25492182, 0.14121641, -0.18148243, 0.03085358, 0.31374934, 0.27850679, 0.16467701, -0.05468489, 0.03318407, 0.25353900, 0.15874241, -0.21472034, 0.25797635, 0.08420319 },
    { 0.04577527, 0.28108335, -0.31893310, -0.09386346, 0.05739922, 0.18723352, 0.29032788, 0.14867269, 0.09675039, 0.01587407, 0.19704013, -0.01817647, -0.10746658, -0.23882319, -0.16452523, -0.21121246, -0.12411053, -0.01409339, -0.05148141, -0.19989078, 0.09229487, -0.14170453, -0.10161290, -0.10976958, -0.03212539, -0.16831101, -0.19437066, -0.01475800, -0.01081208, -0.04455482, 0.20614505, -0.00618551 },
    { -0.09707677, -0.36264595, -0.25024912, 0.13022825, 0.03781169, -0.07009994, -0.07005033, 0.16782011, -0.06241948, 0.03193847, 0.05051171, 0.09168541, 0.14440271, 0.30698770, 0.08441623, 0.10713353, 0.16345359, -0.07453284, 0.25776410, -0.03707934, -0.05585021, -0.03083239, 0.34602439, 0.09436667, -0.07247140, -0.05177297, -0.05267678, 0.03593369, -0.05098769, -0.09242959, 0.10225184, 0.34140047 },
    { -0.21155360, 0.00885336, -0.17482202, 0.15147372, 0.02158145, -0.21668671, -0.16793166, 0.21928571, 0.23391080, -0.12475171, 0.15885557, -0.21440527, -0.00106983, -0.19722784, -0.21406633, -0.15838236, 0.14399406, 0.09688691, 0.08626878, -0.03939335, -0.08190387, -0.01957922, -0.00796688, -0.21960716, 0.13099088, 0.21892977, 0.00470652, 0.23110756, -0.19010194, 0.05930875, -0.02602357, -0.16719267 },
    { 0.05812633, -0.26541090, -0.06744026, 0.19864056, -0.13192420, -0.08370247, -0.00252523, -0.11249252, 0.23162860, -0.20920084, 0.21072826, 0.07030469, 0.10787579, 0.23162925, 0.07081188, -0.07860538, -0.19865207, -0.07275023, 0.23294516, -0.05860380, -0.17524767, 0.17223357, -0.09892583, -0.02774745, 0.06439362, -0.03386464, 0.12387249, 0.16308846, 0.00564004, -0.11933866, 0.07880077, -0.05638010 },
    { 0.09607862, -0.23288749, -0.23195174, -0.25019765, -0.09991750, 0.05457411, 0.28389788, 0.13990532, 0.06710684, -0.24305944, -0.02076722, -0.02637787, -0.13919099, 0.16835979, 0.22027943, 0.27129173, 0.04398631, 0.17678469, 0.09640737, 0.04554541, -0.24890834, 0.02378699, -0.11342340, 0.26181152, -0.21994253, -0.30478317, 0.33254799, -0.17358635, -0.06125670, 0.11481857, 0.01918151, -0.09423096 },
    { -0.18947998, -0.00191399, 0.03296964, -0.10103145, 0.27540529, 0.18025713, -0.07732722, 0.18728219, -0.17543772, -0.05796588, 0.20160852, -0.09731409, 0.20029943, 0.11452419, 0.18334773, 0.10840550, 0.11203715, -0.10557766, -0.21591820, 0.08119604, -0.03434229, 0.16467655, 0.21492976, 0.12093161, 0.20795350, -0.10142188, -0.09690224, 0.20459281, 0.10445871, 0.19453932, 0.16904421, 0.03062789 },
    { 0.31359622, -0.19213153, 0.13833743, -0.06861691, -0.03863562, -0.21936876, 0.02266124, -0.19745910, -0.13837785, -0.03254350, -0.22635415, 0.16901834, -0.03632181, 0.20273364, 0.24033388, 0.06552994, 0.25764328, 0.03931835, 0.08879900, -0.10667109, -0.21001923, 0.02484647, -0.15514429, 0.26440898, -0.20030291, 0.03740068, 0.43013650, 0.01109009, -0.07919331, 0.01647788, 0.21834879, 0.22895482 },
    { -0.03841221, 0.04475877, 0.03352864, 0.00940619, 0.23307289, -0.21261185, -0.26934123, 0.09120713, 0.15667415, -0.14967789, -0.23753424, -0.19725457, 0.14687885, 0.10509486, -0.23809946, -0.08160427, -0.28908110, -0.12588860, -0.03816923, -0.13136233, -0.22374654, 0.01897879, 0.24823618, 0.05269949, 0.12458029, 0.14498392, -0.25669676, -0.19032136, 0.25271085, 0.08742487, -0.13355806, 0.19712202 },
    { 0.13194788, -0.14186221, -0.14581227, 0.12277881, -0.08566958, -0.03142080, 0.00850312, -0.05445940, -0.03599523, -0.05684704, -0.24759680, 0.13299434, -0.11928958, -0.01439451, -0.05344417, -0.06701469, 0.25753725, 0.07516393, 0.07498081, -0.00263052, -0.07406235, 0.06253576, 0.05052583, 0.16627494, 0.24880224, -0.16354832, 0.12445879, 0.31947693, 0.00361980, 0.19646262, 0.03400356, -0.09443603 },
    { -0.30036545, 0.29661557, 0.15376958, -0.09500288, 0.02266758, 0.19454160, 0.24314037, 0.20749530, 0.19178720, 0.22832996, -0.15872312, -0.22091824, -0.10038000, -0.13692376, -0.21884635, -0.21320327, 0.14627601, -0.17058095, 0.05567877, -0.33729410, 0.03562289, -0.14670736, 0.10528036, -0.07403784, -0.00508815, 0.37200773, -0.11914288, 0.12998824, -0.16259477, 0.17246705, 0.07175194, -0.08464803 },
    { 0.05959650, 0.04240530, -0.24671900, -0.20904967, 0.13558570, -0.08437361, -0.08024606, -0.10295968, -0.24802344, -0.00415355, -0.07634042, 0.03401387, -0.07920916, -0.03158250, 0.14098048, 0.18214700, 0.06367722, -0.19107136, 0.19502491, 0.06109142, -0.08255595, 0.12266760, -0.27446094, 0.11814371, -0.16478087, -0.34668991, 0.23505974, 0.18298300, 0.10313702, -0.20325127, -0.00332094, -0.19926958 },
    { -0.02914166, -0.17483604, 0.21540034, 0.21627945, 0.13691086, -0.18744653, -0.03632516, 0.19758523, 0.10891527, -0.10740280, -0.07045221, 0.16369534, 0.22129053, 0.04124933, -0.14179993, 0.08277428, 0.04480946, -0.14571404, 0.08163869, -0.17995006, 0.01208192, -0.09835488, -0.19068342, -0.17060024, 0.15414530, -0.11113489, -0.05510616, -0.08455062, -0.14332384, -0.21417230, -0.24651110, 0.09467316 },
    { 0.20876539, 0.07103022, 0.27329019, 0.06462632, 0.08825230, -0.20981443, 0.05414255, -0.24007675, -0.01828734, 0.16697238, 0.02162337, -0.22457825, 0.12720872, -0.42304000, 0.03407193, 0.07372151, 0.28602049, -0.09140337, 0.11980192, -0.08041039, 0.20400405, -0.11078972, -0.19776469, -0.20729858, -0.09695569, 0.25709656, -0.17813466, -0.24038716, -0.17273639, 0.16894481, -0.08675959, 0.18758759 },
    { -0.12588219, 0.24849327, 0.19431059, 0.18232332, -0.13279077, 0.01359476, 0.21649234, 0.15662186, -0.02433311, -0.21880904, -0.07892374, 0.06917613, 0.10230190, 0.04739630, -0.26641500, -0.04831807, -0.17585632, -0.14613107, 0.05363733, 0.09791241, 0.14222229, -0.04209873, -0.33053839, -0.01034627, -0.19764057, -0.23033595, -0.26209620, 0.07383723, -0.07489895, 0.17465107, -0.16607212, 0.02436558 },
    { -0.09432554, 0.19150543, 0.12548137, 0.13336504, 0.13779670, -0.23453093, -0.15425664, -0.19624811, 0.23103786, 0.12294531, 0.15156436, 0.00200468, -0.17756063, 0.16774976, -0.04048043, -0.01259822, -0.07524294, -0.07412946, 0.22486347, 0.11487317, 0.24791908, 0.07168156, -0.07956195, 0.13147485, 0.00680453, -0.16107047, -0.11590487, -0.11987162, 0.15775484, -0.10793871, 0.21573192, 0.15621227 },
    { 0.13746867, -0.28313273, 0.15250830, -0.15304402, 0.00359088, -0.21119967, -0.00168657, -0.12656993, 0.12223814, -0.27374023, -0.04903430, -0.09252604, 0.23736097, 0.24650232, -0.08047738, 0.21238300, 0.11384176, 0.14485668, 0.16421595, -0.03209390, -0.23601627, -0.10476086, -0.04488262, 0.17657708, -0.21681321, -0.15641293, -0.18739983, 0.19470744, 0.03889982, -0.05985243, -0.12010768, -0.14212407 },
    { -0.32843325, -0.20054777, -0.39954063, -0.16820031, 0.30085430, 0.03956375, -0.11248132, 0.02809721, 0.16262695, 0.45077789, 0.06580346, 0.36590824, -0.09100362, 0.32109818, -1.58146834, -0.91060126, -0.45280534, -0.02679567, 0.35907561, 0.50613981, 0.06249183, -0.04893464, -0.07998262, 0.21824579, 1.37502635, -0.15032893, -1.28766239, 0.48781860, -1.01211464, 0.08030015, -0.74014282, 0.25280482 },
    { 0.13449132, 0.12626588, -0.02749031, -0.15268411, 0.01963826, -0.11305113, -0.03825743, -0.07780951, -0.00043198, 0.25381151, -0.08436703, -0.21452211, -0.26021314, 0.06550542, -0.07500830, -0.12974143, -0.14113881, 0.10988784, -0.17867225, -0.07512425, -0.24844283, -0.10912330, 0.09181309, -0.04477476, -0.01739454, -0.03973003, -0.20997609, 0.04839276, 0.04290494, -0.06857482, 0.06558303, -0.07839409 },
    { 0.23839736, 0.19596004, -0.15885311, -0.19171280, 0.00814962, 0.01632839, -0.01252919, 0.10416454, 0.21388990, 0.19389701, 0.24970037, -0.03971642, 0.02320737, -0.16249526, -0.20515323, -0.07770127, -0.12312943, 0.19465077, 0.10060781, 0.07406604, -0.10790652, 0.01692742, 0.19979489, 0.06175411, 0.19891095, 0.00648195, 0.06338441, 0.24588394, 0.07338679, -0.18232751, -0.01354444, 0.04511899 },
    { -0.30915257, 0.27182293, 0.39686430, -0.19509909, -0.11992087, 0.09281336, -0.12694818, 0.12453881, 0.02492362, 0.28875706, 0.05150738, -0.19369103, -0.75904369, -1.08009207, 0.10359938, -0.30445480, 0.27799183, 0.04399457, -1.05952942, -0.07050217, 0.07815254, -0.22237517, 0.04506048, -0.05884972, -0.12826541, 0.41778207, -0.01786251, -0.06597725, -0.26235965, -0.05991969, -0.23801732, -0.37106931 },
    { 0.19034095, 0.03054761, 0.10793522, -0.16921858, -0.07249331, -0.11510287, -0.21494606, 0.08120161, -0.18519169, -0.20785458, -0.03381965, -0.26406106, 0.08299354, -0.50694185, 0.13769719, 0.16940270, 0.02556241, 0.08597314, -0.08192129, -0.20502076, -0.17684364, -0.22243094, -0.05108267, -0.09376497, -0.32391360, -0.01814079, 0.37607282, -0.04402539, -0.03895207, -0.24233200, 0.23769927, -0.15780532 },
};

// Layer 2 Bias (32)
const fixed16_2 b2[32] = { 0.06367895, 0.01399972, 0.00522177, -0.02522325, 0.05211289, -0.01904221, 0.05305107, -0.03069496, -0.01354363, -0.02721255, -0.01643521, 0.04403205, -0.01924036, -0.00496017, 0.02481018, 0.05758933, 0.04743646, 0.05516369, -0.02063653, 0.05783406, 0.00000000, -0.04271458, 0.07965712, 0.05245185, 0.01984928, 0.02050060, 0.01477841, 0.04529243, 0.06250536, -0.01645390, 0.05455482, 0.07265159 };

// Layer 3 Weights (32 x 16)
const fixed16_2 W3[32][16] = {
    { -0.29665586, -0.18475302, 0.18144596, 0.29673854, 0.37036017, -0.29037717, -0.21392013, 0.12612760, 0.31398165, 0.17855291, 0.22522113, 0.28965691, 0.01975295, 0.21994938, 0.01429403, -0.36478353 },
    { 0.27096748, -0.12555215, -0.03995941, -0.28938848, -0.03227759, 0.13928050, 0.19987944, -0.67268968, -0.20918562, -0.06556565, -0.37676445, -0.41421080, -0.33151388, -0.13127297, 0.30057469, 0.12348310 },
    { 0.22734724, -0.28965604, -0.27223122, -0.14955555, -0.07336117, -0.09227386, 0.38210687, -0.28392738, 0.44484210, -0.16288751, 0.05195081, -0.19325225, -0.01457825, 0.12578994, -0.03833935, 0.20534550 },
    { -0.15947373, -0.29548255, 0.20381036, 0.33581421, 0.14022346, -0.32439545, 0.08783947, 0.02349382, -0.30736351, 0.12761742, 0.05397001, -0.08150261, 0.13993275, -0.30478939, 0.33189234, -0.28160524 },
    { -0.09883466, 0.15199307, 0.28430611, 0.09846994, 0.05935167, -0.30867645, 0.06714388, 0.11977728, -0.11606852, 0.03859210, -0.03969926, 0.33700114, -0.20835337, 0.38210064, 0.00725571, 0.26068956 },
    { 0.21403641, 0.11547367, 0.29697058, -0.19616963, 0.01564719, -0.32919142, 0.04983014, 0.26914272, -0.10814925, -0.18582973, 0.05109472, 0.05609010, 0.33324018, -0.12595017, 0.32025990, 0.18979815 },
    { -0.30743203, 0.23415212, -0.32465446, 0.34274337, -0.17553769, 0.02180335, 0.16703181, -0.10679653, 0.05351168, 0.26489371, -0.31308916, 0.31850755, -0.15993810, 0.31168842, 0.08808629, 0.00212982 },
    { 0.18400769, -0.19553576, -0.07352141, -0.00499575, -0.27941540, 0.34730789, 0.15371150, -0.19095778, 0.13046254, -0.10755300, 0.04966637, -0.18356916, -0.19544749, -0.27099952, -0.21038777, 0.33243102 },
    { -0.24264680, 0.03659292, 0.09128484, 0.17419906, 0.25390792, 0.15898660, 0.09936357, 0.15069334, 0.24447395, 0.18075146, 0.00939283, 0.21542108, -0.12896986, -0.24186344, -0.01102107, 0.34612355 },
    { -0.08056252, -0.28441763, 0.12618935, -0.07546686, -0.20360354, -0.21504799, -0.29278934, -0.38586953, -0.27834007, 0.06167778, 0.24296114, 0.13058385, 0.18353900, 0.02140506, 0.24169089, -0.11638426 },
    { 0.13597159, -0.21190567, -0.31409001, -0.14106527, -0.24456343, -0.30241174, 0.20536557, 0.28810349, 0.19626771, -0.23698819, -0.26883394, -0.17454150, -0.34755850, -0.23949921, 0.14526500, -0.23322926 },
    { -0.21046157, 0.20985928, -0.35992256, 0.14107369, -0.04874017, -0.13549243, 0.02388139, 0.04354538, 0.13610238, 0.29078609, -0.18485887, 0.40515846, -0.25224087, 0.22784741, -0.33616871, -0.20782357 },
    { -0.23703901, -0.11901662, -0.12162606, -0.09640289, 0.10937870, -0.33192766, -0.00879216, -0.27798074, 0.35108730, 0.38698360, 0.17099877, 0.20679173, -0.30895630, -0.03543437, 0.09099194, 0.13061377 },
    { 0.00070965, -0.07727268, -0.21484518, -0.16726488, 0.69280916, 0.30027875, 0.13460021, -1.13350213, 0.54082394, 0.26120088, 0.03093996, -0.27605334, -0.26441306, -0.21916056, 0.04785200, 0.15856685 },
    { -0.15907869, -0.30873886, -0.31906036, 0.15296106, 0.45954901, -0.38138542, -0.54354209, -0.31370667, 0.02432786, 0.19997056, 0.27062756, -0.12417243, -0.17283402, 0.16913462, -0.28624716, -0.15884763 },
    { 0.18191421, 0.25483885, -0.30079874, 0.08706810, 0.35254025, -0.13418421, -0.36485809, 0.14314663, 0.17118782, 0.17731462, 0.21185195, -0.06592164, -0.04743123, 0.40019429, 0.03910232, -0.30181789 },
    { -0.43061849, -0.34528062, 0.23703021, 0.36979795, 0.34351718, 0.25423139, 0.17913359, -0.20561357, 0.08841213, -0.17788164, -0.33478272, 0.18751854, -0.23288409, 0.35264447, 0.36556664, -0.28567368 },
    { -0.18147734, 0.14024822, -0.13006093, 0.17184797, -0.05228240, -0.16324103, 0.20277032, -0.07674184, 0.26146469, 0.36005187, 0.13492481, 0.38718498, -0.08689153, 0.29542106, 0.08691568, -0.29018649 },
    { -0.15257505, 0.26219535, -0.06316304, -0.30872637, -0.40823820, -0.09599611, 0.16090015, -1.01251638, -0.10171019, -0.29029235, -0.21069033, -0.22760750, 0.00492546, -0.30535632, 0.00035658, -0.13991490 },
    { 0.29618317, -0.08247619, 0.27461684, 0.30501935, -0.28848204, -0.08212102, -0.10329404, 0.35439467, 0.27627325, -0.22783929, 0.26789951, -0.17416455, -0.03241438, 0.39299917, -0.00153141, 0.17874867 },
    { 0.16863206, 0.03527960, -0.19630282, 0.33449170, 0.04970461, 0.06434122, -0.11039558, 0.00730515, 0.23395708, 0.25035170, 0.30480811, 0.10763234, -0.33044064, 0.24187413, -0.01482069, -0.19174203 },
    { -0.10209769, 0.02171236, -0.06854478, -0.25565618, 0.04569742, -0.11936367, -0.13611923, -0.30711472, 0.24100518, 0.23821466, 0.05216735, -0.26665279, -0.14604001, -0.31237042, -0.09037307, 0.20535745 },
    { -0.41120231, -0.29023123, -0.03079814, 0.21177444, -0.16256103, 0.05560549, 0.16183083, 0.40970457, 0.04251851, 0.28972542, -0.16397384, 0.09748315, -0.21550687, 0.28413895, 0.00680838, 0.21604893 },
    { -0.25266552, -0.34883562, 0.15321299, 0.11494578, 0.02204391, 0.24029720, 0.04355785, 0.30962488, 0.13531694, 0.18056844, -0.28738844, 0.00921096, 0.23787448, 0.23928998, 0.29167670, 0.03465880 },
    { 0.28937355, 0.03265276, -0.40951434, -0.14538974, -0.46194610, 0.33759168, 0.03190744, 0.04724125, -0.24386854, 0.10424761, -0.33010003, 0.09729117, 0.12591952, 0.24486355, 0.27089810, -0.13974404 },
    { 0.04588770, 0.21932323, 0.06978933, -0.50759757, -0.18083027, 0.08821058, 0.34624276, -0.16191208, 0.18524024, 0.12989207, 0.05782797, -0.47585765, -0.27243572, -0.06956882, 0.41108239, -0.11446898 },
    { 0.18432303, 0.06970618, 0.32473743, 0.40921962, 0.26456085, -0.65263420, 0.05175744, -0.20367904, 0.14354669, -0.09326160, -0.24784426, -0.26664835, 0.10406005, -0.08598565, -0.36988482, -0.06739345 },
    { 0.06577838, -0.06003481, -0.25492200, 0.20090874, -0.26997897, -0.18793629, 0.15914078, 0.13386771, 0.03759576, 0.09690266, -0.24979919, 0.42426124, -0.28218639, 0.07427505, -0.20862369, -0.25497511 },
    { -0.08927194, -0.19716951, 0.15426689, 0.16830878, 0.37103829, -0.03589808, -0.15233585, 0.23884580, 0.24846134, -0.27766445, 0.07233108, 0.31144306, 0.34739271, 0.03186641, -0.02061325, -0.22386986 },
    { -0.16442555, 0.19698140, 0.29103544, 0.32025895, 0.04338692, 0.16435626, -0.06729993, -0.07573873, -0.18488523, 0.09548641, 0.17980629, 0.31349027, 0.09573403, -0.13719583, 0.10513771, 0.30531335 },
    { -0.38422430, 0.16230834, 0.25265700, -0.20565991, 0.36931682, -0.14399433, -0.28710911, 0.24293096, 0.39570057, 0.08151042, 0.05347139, 0.24700643, 0.21705011, 0.34754038, 0.16438282, -0.08711436 },
    { 0.07459283, -0.16990982, -0.34137142, 0.32841131, 0.04197417, -0.27670357, -0.02033886, 0.26719999, -0.35851276, 0.39476374, 0.17444414, 0.27846617, 0.09287614, 0.20432979, -0.28211454, -0.12310394 },
};

// Layer 3 Bias (16)
const fixed16_2 b3[16] = { -0.11404539, -0.02750733, -0.06791006, 0.05692152, 0.04243165, 0.00390508, 0.08924296, 0.07622185, 0.04053652, 0.04740242, -0.03634460, 0.04911331, 0.00000000, 0.04362572, -0.01484940, 0.01019118 };

// Layer 4 Weights (16 x 2)
const fixed16_2 W4[16][2] = {
    { 0.25023994, 0.21554945 },
    { 0.33144540, -0.08471935 },
    { 0.36729306, 0.06717069 },
    { -0.22676343, -0.23160031 },
    { 0.21805459, -0.69057161 },
    { 0.29186326, -0.43842238 },
    { -0.70310962, -0.34989277 },
    { -0.57775372, 0.07856017 },
    { 0.06317095, -0.44555110 },
    { -0.13933529, -0.07970502 },
    { 0.39265925, -0.23054919 },
    { -0.31215462, 0.09415100 },
    { 0.25627071, -0.30394268 },
    { -0.47412363, -0.33007252 },
    { 0.32952899, 0.39359412 },
    { -0.07708257, 0.03529289 },
};

// Layer 4 Bias (2)
const fixed16_2 b4[2] = { -0.04373866, -0.03969523 };


// ------------------------
// Activation 함수
// ------------------------
fixed16_8 relu_hls(fixed16_8 x){ 
    const fixed16_8 zero = 0;
    return x > zero ? x : zero;
}

// LUT 기반 sigmoid
fixed16_2 sigmoid_hls(fixed16_8 x){
#pragma HLS INLINE
    const fixed16_8 SIGMOID_MIN = -8.0f;
    const fixed16_8 SIGMOID_MAX = 8.0f;
    if(x < SIGMOID_MIN) x = SIGMOID_MIN;
    if(x > SIGMOID_MAX) x = SIGMOID_MAX;
    int idx = (int)((x - SIGMOID_MIN)/(SIGMOID_MAX - SIGMOID_MIN) * (SIGMOID_LUT_SIZE-1));
    return sigmoid_lut[idx];
}

// ------------------------
// HLS FFNN 함수
// ------------------------
void ffnn_hls(fixed16_8 new_data[INPUT_SIZE], fixed16_2 output[OUTPUT_SIZE]){

              
    fixed16_8 input_vector[INPUT_SIZE];
    for(int i=0;i<INPUT_SIZE;i++){
        input_vector[i] = new_data[i];
    }



// ------------------------
// 3) Forward Layers
// ------------------------
    fixed16_8 layer1[L1], layer2[L2], layer3[L3];

    // Layer1: unroll=3 + block partition
#pragma HLS ARRAY_PARTITION variable=W1 block factor=2 dim=2
    for(int i=0;i<L1;i++){
    #pragma HLS PIPELINE
        fixed16_8 sum = b1[i];
        for(int j=0;j<INPUT_SIZE;j++)
            sum += W1[j][i]*(fixed16_8)input_vector[j];
        layer1[i] = relu_hls(sum);
        
    }

  

    // Layer2: unroll=3 + block partition
#pragma HLS ARRAY_PARTITION variable=W2 block factor=2 dim=2
    for(int i=0;i<L2;i++){
    #pragma HLS PIPELINE
        fixed16_8 sum = b2[i];
        for(int j=0;j<L1;j++)
            sum += W2[j][i]*layer1[j];
        layer2[i] = relu_hls(sum);
        
    }

    // Layer3: pipeline만
    for(int i=0;i<L3;i++){
    #pragma HLS PIPELINE
        fixed16_8 sum = b3[i];
        for(int j=0;j<L2;j++)
            sum += W3[j][i]*layer2[j];
        layer3[i] = relu_hls(sum);
        
    }

    // Layer4: pipeline만 + LUT sigmoid
    for(int i=0;i<OUTPUT_SIZE;i++){
    #pragma HLS PIPELINE
        fixed16_8 sum = b4[i];
        for(int j=0;j<L3;j++)
            sum += W4[j][i]*layer3[j];
        output[i] = sigmoid_hls(sum);
        
    }
}

void top_heading_error_ffnn(fixed16_8 new_data[FEATURE_SIZE],
              fixed16_2 output[OUTPUT_SIZE]
){
#pragma HLS INTERFACE s_axilite port=return
#pragma HLS INTERFACE s_axilite port=new_data
#pragma HLS INTERFACE s_axilite port=output

    ffnn_hls(new_data, output);



}

